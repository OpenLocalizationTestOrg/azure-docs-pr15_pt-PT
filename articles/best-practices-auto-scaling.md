<properties
   pageTitle="Orientações Autoscaling | Microsoft Azure"
   description="Orientação sobre como autoscale dinamicamente atribuir recursos necessários por uma aplicação."
   services=""
   documentationCenter="na"
   authors="dragon119"
   manager="christb"
   editor=""
   tags=""/>

<tags
   ms.service="best-practice"
   ms.devlang="na"
   ms.topic="article"
   ms.tgt_pltfrm="na"
   ms.workload="na"
   ms.date="07/13/2016"
   ms.author="masashin"/>

# <a name="autoscaling-guidance"></a>Orientações Autoscaling

[AZURE.INCLUDE [pnp-header](../includes/guidance-pnp-header-include.md)]

## <a name="overview"></a>Descrição geral
Autoscaling é o processo de atribua dinamicamente os recursos necessários por uma aplicação para que correspondam aos requisitos de desempenho e satisfazem os acordos do nível de serviço (SLA), enquanto minimizar runtime custos. À medida que o volume de trabalho cresce, uma aplicação poderá necessitar de recursos adicionais para ativá-la efetuar as suas tarefas forma atempada. Conforme pedido slackens, os recursos podem ser retirar a atribuição para minimizar os custos, ainda mantendo desempenho adequado e SLA da reunião.
Autoscaling tira partido das elasticidade ambientes de alojados em nuvem enquanto facilitação gerais de gestão. Para o fazer, reduzir a necessidade de um operador para monitorizar o desempenho de um sistema de forma contínua e tomar decisões sobre a adição ou remoção de recursos.
>[AZURE.NOTE] Autoscaling aplica-se a todos os recursos utilizados por uma aplicação, não apenas os recursos de cluster. Por exemplo, se o seu sistema utiliza filas de mensagem para enviar e receber informações,-podia criar filas adicionais à medida que escalas.

## <a name="types-of-scaling"></a>Tipos de dimensionamento
Dimensionamento normalmente leva-o até uma das duas seguintes formas:

- **Vertical** (muitas vezes como _dimensionamento cima e para baixo_). Este formulário requer que modifique o hardware (expandir ou reduzir a sua capacidade e desempenho), ou implementar a solução utilizando hardware alternativo, que tem a capacidade apropriada e o desempenho. Num ambiente na nuvem, a plataforma de hardware é normalmente num ambiente virtualizado. A menos que o hardware original foi substancialmente overprovisioned com as despesas de capital processo decorra consecutivas, verticalmente escalar para cima neste ambiente envolve aprovisionamento recursos mais eficazes e, em seguida, movendo o sistema para estes novos recursos. Dimensionamento vertical com frequência é um processo desorganização que necessita de efetuar o sistema temporariamente indisponível enquanto-la novamente está a ser implementada. Poderá ser possível manter o sistema original em execução enquanto o novo hardware está aprovisionado e importados online, mas não existem provavelmente serão algumas interrupções enquanto as transições de processamento do ambiente de antiga para a nova. É invulgar utilizar autoscaling para implementar uma estratégia de dimensionamento vertical.
- **Horizontal** (muitas vezes como _dimensionamento saída e no_). Este formulário requer implementar a solução no adicionais ou menos recursos, que são normalmente recursos de produto importante em vez de sistemas transpor. A solução pode continuar a trabalhar rapidamente sem interrupções enquanto configurações para estes recursos. Quando o processo de aprovisionamento estiver concluído, podem ser implementadas nestes recursos adicionais e disponibilizadas cópias dos elementos que compõem a solução. Se a pedido descer, os recursos adicionais podem ser recuperados depois dos elementos utilizá-los tem sido encerrados correctamente. Muitos sistemas baseado na nuvem, incluindo Microsoft Azure, suportam automatização deste formulário do dimensionamento da.

## <a name="implement-an-autoscaling-strategy"></a>Implementar uma estratégia de autoscaling
Implementar uma estratégia de autoscaling normalmente envolve os seguintes componentes e processos:

- Instrumentação e sistemas em níveis de aplicação, o serviço e infraestrutura de monitorização. Estes sistemas capturam métricas chave, tais como os tempos de resposta, comprimentos fila de espera, a utilização da CPU e a utilização de memória.
- Lógica tomada de decisões que pode avaliar os fatores dimensionamento monitorizados contra limiares predefinidas do sistema ou agendas e tomar decisões relativas ao facto dimensionar ou não.
- Componentes de que forem o responsáveis da realização das tarefas associadas dimensionamento sistema, como de aprovisionamento ou anular aprovisionamento recursos.
- Teste, monitorização e optimização da estratégia autoscaling para se certificar de que funciona como esperado.

A maior parte dos ambientes baseado na nuvem, como o Azure, mecanismos autoscaling incorporados que cenários comuns de endereço. Se o ambiente ou serviço que utiliza não fornece que as necessárias automatizado funcionalidade dimensionamento ou se tiver autoscaling representarem requisitos para além das suas capacidades, poderá ser necessária uma implementação personalizada. Utilize esta implementação personalizada para recolher e métricas do sistema operacional, analisá-los para identificar dados relevantes e, em seguida, dimensionar recursos, consoante adequado.


## <a name="configure-autoscaling-for-an-azure-solution"></a>Configurar autoscaling para uma solução Azure
Existem várias opções para configurar autoscaling para as soluções do Azure:

- **Azure Autoscale** suporta os cenários de dimensionamento mais comuns com base numa agenda e, opcionalmente, acionou dimensionamento operações com base na métricas de runtime (como a utilização do processador, comprimento da fila ou contadores incorporados e personalizados). Pode configurar políticas de autoscaling simples para uma solução de forma rápida e fácil utilizando o portal do Azure. Para mais detalhadas controlo, pode fazer de [Azure Service gestão REST API](https://msdn.microsoft.com/library/azure/ee460799.aspx) ou [REST API do Azure Gestor de recursos](https://msdn.microsoft.com//library/azure/dn790568.aspx). A [Biblioteca de gestão de serviço de monitorização do Azure](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring) e a [Biblioteca de informações da Microsoft](https://www.nuget.org/packages/Microsoft.Azure.Insights/) (na pré-visualização) estão SDK, que permitem a recolha de métricas de diferentes recursos e executar autoscaling ao efetuar a utilização das APIs do resto. Para recursos sempre que o Gestor de recursos do Azure suporte não está disponível, ou se estiver a utilizar serviços em nuvem Azure, o serviço de gestão de REST API pode ser utilizado para autoscaling. Em todos os outros casos, utilize o Gestor de recursos do Azure.
- **Uma solução personalizada**, com base no seu instrumentação relativo à aplicação e funcionalidades de gestão do Azure, pode ser útil. Por exemplo, pode utilizar o Azure diagnóstico ou outros métodos de instrumentação na sua aplicação, juntamente com código personalizado para continuamente monitorizar e exportar métricas da aplicação. Pode ter regras personalizadas que funcionam nestas métricas e utilize a gestão de serviço ou Gestor de recursos REST API do acionado autoscaling. Métricas para acionar uma operação de dimensionamento podem ser qualquer contador incorporada ou personalizada ou outras instrumentação que implementar dentro da aplicação. No entanto, uma solução personalizada não é simples implementar e devem ser consideradas apenas se nenhuma das abordagens anterior poderá responder às suas necessidades. O [Bloco de aplicações Autoscaling](http://msdn.microsoft.com/library/hh680892%28v=pandp.50%29.aspx) utiliza esta abordagem.
- **Serviços de terceiros**, como [Paraleap AzureWatch](http://www.paraleap.com/AzureWatch), permitem-lhe dimensionar uma solução baseada em agendas, indicadores de desempenho de carga e de sistema do serviço, regras personalizadas e combinações de diferentes tipos de regras.

Quando escolher qual a solução autoscaling para adotar, considere os seguintes pontos:

- Utilize as funcionalidades de autoscaling incorporadas da plataforma, se pode correspondem aos seus requisitos. Caso contrário, considere cuidadosamente se realmente precisa de mais complexas dimensionamento funcionalidades. Alguns exemplos de requisitos adicionais podem incluir mais granularidade de controlo, as diferentes maneiras de detetar eventos de accionador para dimensionamento, dimensionamento entre subscrições, dimensionamento e outros tipos de recursos.
- Considere se pode prever a carga da aplicação com uma precisão suficiente para dependem apenas autoscaling agendada (adicionar e remover instâncias para cumprir picos antecipados na procura). Em que esta não é possível, utilize autoscaling reactivar com base na métricas recolhidas o tempo de execução, para permitir que a aplicação para processar alterações inesperadas no pedido. Normalmente, pode combinar estas abordagens. Por exemplo, crie uma estratégia que adiciona recursos, tais como cluster, armazenamento e filas, com base numa agenda de vezes quando souber que a aplicação está ocupada mais. Isto ajuda a garantir que capacidade está disponível quando for necessário, sem o atraso que se tenha deparado ou ao iniciar novas instâncias. Além disso, para cada regra agendada, defina métricas que permitem autoscaling reactivar durante o período para se certificar de que a aplicação pode processar picos constante mas inesperados no pedido.
- Muitas vezes é difícil compreender a relação entre métricas e a capacidade de requisitos, especialmente quando uma aplicação é inicialmente implementada. Prefere aprovisionar um pouco capacidade extra no início e, em seguida, monitorizar e optimizar as regras de autoscaling para trazer o mais perto da capacidade para a carregar real.

### <a name="use-azure-autoscale"></a>Utilizar Azure Autoscale
Autoscale permite-lhe configurar escala de saída e dimensionar nas opções para obter uma solução. Autoscale automaticamente pode adicionar e remover instâncias da web de serviços em nuvem Azure e funções de trabalho, serviços de Mobile Azure e funcionalidade do Web Apps na aplicação de serviço de Azure. Também pode ativar a escala automática por iniciar e parar instâncias de máquinas virtuais do Azure. Uma estratégia de Azure autoscaling inclui dois conjuntos de fatores:

- Autoscaling baseada na agenda que pode garantir ocorrências adicionais estão disponível para coincidir com um pico esperado na utilização e pode dimensionar no assim que a hora de pico passou. Isto permite-lhe para se certificar de que tem instâncias suficientes já em execução, sem aguardar que o sistema de responder a carregar.
- Autoscaling com base em métricas reage a fatores como a utilização da CPU média através de última hora ou o registo de tarefas pendentes das mensagens que está a processar num Azure armazenamento ou fila Azure Service Bus a solução. Esta opção permite-a aplicação reagir separadamente a partir das regras de autoscaling agendada para acomodar planeadas ou imprevistas alterações no pedido.

Quando utilizar Autoscale, tenha em consideração os seguintes pontos:

- Sua estratégia de autoscaling combina agendada e com base em métricas dimensionamento. Pode especificar os dois tipos de regras para um serviço.
- Deve configurar as regras de autoscaling e, em seguida, monitorizar o desempenho da sua aplicação ao longo do tempo. Utilize os resultados deste monitorização para ajustar a forma na qual o sistema escalas se for necessário. No entanto, tenha em atenção que autoscaling não é um processo instantâneo. Demora tempo para responder a uma métrica como média CPU utilização superior a (ou fiquem abaixo) um limiar especificado.
- As regras de Autoscaling que utilizam um mecanismo de detecção baseado num atributo accionador medido (por exemplo, o comprimento de fila ou a utilização da CPU) utilizam um valor agregado ao longo do tempo, em vez de valores de instantâneos, para acionar uma ação autoscaling. Por predefinição, a função de agregação é uma média dos valores. Isto impede que o sistema de reagindo demasiado rapidamente ou a causar oscilação rápida. Também lhe permite tempo para novas instâncias são automáticos para liquidar para executar em modo, impedindo ações adicionais autoscaling ocorra enquanto novas instâncias estão a ser iniciado. Para serviços em nuvem Azure e máquinas virtuais do Azure, o período de predefinido para a agregação é 45 minutos, por isso, pode demorar até a este período de tempo para a métrica do acionado autoscaling em resposta ao picos no pedido. Pode alterar o período de agregação utilizando o SDK, mas tenha em atenção que períodos de menos de 25 minutos podem causar resultados inesperados (para obter mais informações, consulte o artigo [Automática dimensionamento serviços em nuvem da percentagem de CPU com a biblioteca de gestão de serviços de monitorização Azure](http://rickrainey.com/2013/12/15/auto-scaling-cloud-services-on-cpu-percentage-with-the-windows-azure-monitoring-services-management-library/)). Para aplicações Web, o período de média é muito mais curto, permitindo que novas instâncias esteja disponível em cerca de cinco minutos depois de uma alteração à medida accionador média.
- Se configurar autoscaling utilizando o SDK em vez do portal da web, pode especificar uma agenda mais detalhada durante o qual as regras são ativas. Também pode criar o seus próprio métricas e utilizá-los com ou sem qualquer uma das já existentes no seu autoscaling regras. Por exemplo, poderá pretender utilizar contadores alternativos, tais como o número de pedidos de por segundo ou a disponibilidade de memória média ou utilizar contadores personalizados que medem processos de negócio específicos.
- Quando autoscaling máquinas virtuais do Azure, tem de implementar um número de ocorrências da máquina virtual que é igual ao número máximo permitirá autoscaling começar. Estas instâncias devem fazer parte do mesmo conjunto de disponibilidade. O mecanismo de autoscaling máquinas virtuais não criar ou eliminar instâncias de máquina virtual; em vez disso, as regras de autoscaling que configurar irão iniciar e parar um número adequado destas instâncias. Para mais informações, consulte o artigo [Dimensionar automaticamente uma aplicação executar funções da Web, funções de trabalho ou máquinas virtuais](./cloud-services/cloud-services-how-to-scale.md).
- Se não podem ser iniciadas novas instâncias, talvez porque atingiu o número máximo de uma subscrição ou ocorre um erro durante o arranque, o portal poderá mostrar que uma operação de autoscaling bem sucedido. No entanto, subsequentes **ChangeDeploymentConfiguration** eventos apresentados no portal do irão mostrar apenas que foram pedida um arranque do serviço e não haverá nenhum evento para indicar que foi concluída com êxito.
- Pode utilizar o portal de web IU a ligação recursos, tais como instâncias de base de dados SQL e filas uma instância do serviço cluster. Esta opção permite-lhe mais facilmente aceder o separado manual e automático de dimensionamento das opções de configuração para cada um dos recursos ligados. Para obter mais informações, consulte o artigo [como: ligar um recurso num serviço na nuvem](cloud-services-how-to-manage.md#linkresources) e [como dimensionar uma aplicação](./cloud-services/cloud-services-how-to-scale.md).
- Quando configurar vários políticas e as regras, poderá estar em conflito com os outros. Autoscale utiliza as seguintes regras de resolução de conflitos para se certificar de que existe sempre um número suficiente de instâncias em execução:
  - Escala de operações de têm sempre precedência sobre escala em operações.
  - Dimensionar quando terminar de conflito de operações, a regra que inicia o maior aumento no número de instâncias precedência.
  - Quando dimensionar em conflito de operações, a regra que inicia a diminuição menor o número de instâncias precedência.

<a name="the-azure-monitoring-services-management-library"></a>

## <a name="application-design-considerations-for-implementing-autoscaling"></a>Considerações de estrutura da aplicação de execução autoscaling
Autoscaling não constitui uma solução instantânea. Basta adicionar recursos a um sistema ou mais ocorrências de um processo de executar não garantem que irão melhorar o desempenho do sistema. Considere os seguintes pontos ao estruturar uma estratégia de autoscaling:

- O sistema tem de ser concebido para ser dimensionáveis horizontalmente. Evite efetuar suposições sobre afinidade instância; não à estrutura soluções que requerem que o código sempre está em execução numa instância específica de um processo. Quando se escala horizontalmente para um serviço na nuvem ou o web site, não partem do princípio de que uma série de pedidos de origem no mesmo sempre será encaminhada para a instância do mesmo. O mesmo motivo, estruture serviços a não ter estado para evitar que exige uma série de pedidos de uma aplicação a ser encaminhado sempre na mesma instância de um serviço. Ao estruturar um serviço que lê as mensagens a partir de uma fila e processa-las, não fazer qualquer suposições sobre a instância das alças de serviço uma mensagem específica. Autoscaling conseguiu iniciar instâncias adicionais de um serviço como o comprimento da fila cresce. O [Padrão de consumidores competir](http://msdn.microsoft.com/library/dn568101.aspx) descreve como gerir este cenário.
- Se a solução implementa uma tarefa de execução longa, estruture esta tarefa para suportar o dimensionamento saída e de dimensionamento no. Sem conclusão cuidados, como uma tarefa foi impedir que uma instância de um processo que está a ser encerrar correctamente quando o sistema escalas no ou -perder dados se o processo for forçar terminado. Idealmente, reestruturar uma tarefa de execução longa e dividir o processamento que realiza para blocos mais pequenos, descontínuos. A [tubos e filtros padrão](http://msdn.microsoft.com/library/dn568100.aspx) fornece um exemplo de como é possível alcançar isto.
- Em alternativa, pode implementar um mecanismo de ponto de verificação que registos Distrito informações sobre a tarefa em intervalos regulares e guardar este estado no armazenamento resistente que pode ser acedido por todas as ocorrências do processo de executar a tarefa. Desta forma, se o processo for encerramento, o trabalho que foi executar pode ser retomado a partir do último ponto de verificação ao utilizar outra instância.
- Quando tarefas em segundo plano executado num cluster separada instâncias, tal como no trabalho funções dos serviços em nuvem alojado aplicação, poderá ter de dimensionar diferentes partes da aplicação utilizando as políticas de dimensionamento diferentes. Por exemplo, poderá ter de implementar cluster (IU) de interface de utilizador adicionais instâncias sem aumentar o número de fundo calcular instâncias ou o oposto de isto. Se oferecer diferentes níveis de serviço (como pacotes de serviço básico e premium), poderá ter de dimensionar saída os recursos de cluster para pacotes de serviço premium mais agressivo do que os pacotes de serviço básico para satisfazer SLA.
- Considere utilizar o comprimento da fila através da qual IU e fundo calcular instâncias comunicam como critério para a sua estratégia de autoscaling. Este é o indicador de utilizações de uma diferença ou a diferença entre a carga atual e a capacidade de transformação da tarefa de fundo.
- Se basear a sua estratégia de autoscaling no contadores que medem processos de negócio, tais como o número de encomendas por hora ou o tempo de execução médio de uma transação complexa, certifique-se de que totalmente compreender a relação entre os resultados destes tipos de contadores e os requisitos de capacidade de cluster real. Poderá ser necessário Dimensionar mais de um componente ou calcular unidade na resposta com as alterações de contadores de processos de negócio.  
- Para impedir que um sistema de tentar para dimensionar saída demasiado e para evitar os custos associados a execução de vários milhares de instâncias, considere limitar o número máximo de instâncias que podem ser adicionados automaticamente. A maior parte dos autoscaling mecanismos permitem-lhe especificar o número mínimo e máximo de instâncias para uma regra. Além disso, considere correctamente degradar a funcionalidade que fornece o sistema de se o número máximo de instâncias foram implementado e o sistema ainda está sobrecarregado.
- Manter em mente que autoscaling poderão não estar o mecanismos mais adequados para processar uma rajada repentina sobre no carga de trabalho. Demora tempo a aprovisionar e iniciar novas instâncias de um serviço ou adicionar recursos a um sistema e, a procura de pico poderá ter passado por hora que estes recursos adicionais foram efetuados disponíveis. Neste cenário, pode ser melhor optimizar o serviço. Para obter mais informações, consulte o [Limitação padrão](http://msdn.microsoft.com/library/dn589798.aspx).
- Por outro lado, se precisar da capacidade para processar todos os pedidos de quando o volume oscilar rapidamente e custo não é um fator de contribuinte principal, considere utilizar uma estratégia de autoscaling agressivas que inicia ocorrências adicionais mais rapidamente. Também pode utilizar uma política de agendada que inicia um número suficiente de instâncias para cumprir a carga máxima antes de nessa carga é esperada.
- O mecanismo autoscaling deve monitorizar o processo de autoscaling e registar os detalhes de cada evento autoscaling (o que acionou-lo, os recursos que foram adicionados ou removidos e quando). Se criar um mecanismo autoscaling personalizado, certifique-se de que incorpora-esta funcionalidade. Analisar as informações para ajudar a medir a eficácia da estratégia autoscaling e o gráfico se for necessário. Pode sintonizar ambos curto prazo, à medida que os padrões de utilização ficam mais óbvias e durante a longo prazo, tal como o negócio expande ou evoluem os requisitos da aplicação. Se uma aplicação atingir o limite superior definido para autoscaling, o mecanismo também poderá alertar um operador que poderia iniciar manualmente recursos adicionais se for necessário. Tenha em atenção que, nestas circunstâncias, o operador pode também ser responsável removendo manualmente estes recursos após facilita a carga de trabalho.

## <a name="related-patterns-and-guidance"></a>Orientação e padrões relacionados
As seguintes padrões e orientações podem também ser relevantes para seu cenário quando autoscaling de execução:

- [Limitação padrão](http://msdn.microsoft.com/library/dn589798.aspx). Este padrão descreve como uma aplicação pode continuar a funcionar e reunir SLA quando um aumento de procura coloca uma carga representarem em recursos. Limitação pode ser utilizado com autoscaling para impedir um sistema de sejam sobrecarregado enquanto o sistema escalas saída.
- [Competir consumidores padrão](http://msdn.microsoft.com/library/dn568101.aspx). Este padrão descreve como implementar um conjunto de instâncias do serviço que pode lidar com mensagens a partir de qualquer instância da aplicação. Autoscaling pode ser utilizado para iniciar e parar instâncias do serviço para corresponder a carga de trabalho antecipada. Esta abordagem permite que um sistema processar várias mensagens em simultâneo para otimizar débito, melhorar escalabilidade e disponibilidade e equilibrar a carga de trabalho.
- [Orientação de telemetria e instrumentação](http://msdn.microsoft.com/library/dn589775.aspx). Instrumentação e telemetria são essenciais para recolher as informações que podem orientar o processo de autoscaling.

## <a name="more-information"></a>Obter mais informações
- [Como escala de uma aplicação](./cloud-services/cloud-services-how-to-scale.md)
- [Dimensionar automaticamente uma aplicação em execução funções da Web, funções de trabalho ou máquinas virtuais](cloud-services-how-to-manage.md#linkresources)
- [Como: ligar um recurso num serviço na nuvem](cloud-services-how-to-manage.md#linkresources)
- [Dimensionar recursos ligados](./cloud-services/cloud-services-how-to-scale.md#scale-link-resources)
- [Biblioteca de gestão de serviços de monitorização do Azure](http://www.nuget.org/packages/Microsoft.WindowsAzure.Management.Monitoring)
- [Gestão de serviços Azure REST API](http://msdn.microsoft.com/library/azure/ee460799.aspx)
- [API do resto do Gestor de recursos do Azure](https://msdn.microsoft.com/library/azure/dn790568.aspx)
- [Biblioteca do Microsoft Insights](https://www.nuget.org/packages/Microsoft.Azure.Insights/)
- [Operações em Autoscaling](http://msdn.microsoft.com/library/azure/dn510374.aspx)
- [Microsoft.WindowsAzure.Management.Monitoring.Autoscale espaço de nomes](http://msdn.microsoft.com/library/azure/microsoft.windowsazure.management.monitoring.autoscale.aspx)
